<div class="reset-password-container">
  <div class="reset-password-card">
    <!-- Header -->
    <div class="reset-password-header">
      <div class="logo-container">
        <app-icon name="lock_reset" size="48" class="logo-icon"></app-icon>
      </div>
      <h1 class="reset-password-title">Restablecer Contraseña</h1>
      <p class="reset-password-subtitle">Ingresa tu nueva contraseña</p>
    </div>

    <!-- Success Message -->
    @if (successMessage) {
      <div class="success-message">
        <mat-icon>check_circle</mat-icon>
        <div>
          <p class="success-title">¡Contraseña Restablecida!</p>
          <p class="success-text">{{ successMessage }}</p>
          <p class="redirect-text">Redirigiendo al inicio de sesión...</p>
        </div>
      </div>
    } @else {
      <!-- Formulario -->
      <form class="reset-password-form" (ngSubmit)="onSubmit()">
        <!-- Error Message -->
        @if (errorMessage) {
          <div class="error-message">
            <mat-icon>error</mat-icon>
            <span>{{ errorMessage }}</span>
          </div>
        }

        <!-- Nueva Contraseña -->
        <mat-form-field class="form-field" appearance="fill">
          <mat-label>Nueva Contraseña</mat-label>
          <input 
            matInput 
            [type]="hideNewPassword ? 'password' : 'text'"
            [(ngModel)]="newPassword" 
            name="newPassword"
            placeholder="Mínimo 6 caracteres"
            [disabled]="isLoading"
            required
          >
          <button 
            mat-icon-button 
            matSuffix 
            (click)="hideNewPassword = !hideNewPassword" 
            type="button"
            [disabled]="isLoading"
            [attr.aria-label]="'Toggle password visibility'"
          >
            <mat-icon>{{hideNewPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
        </mat-form-field>

        <!-- Confirmar Contraseña -->
        <mat-form-field class="form-field" appearance="fill">
          <mat-label>Confirmar Contraseña</mat-label>
          <input 
            matInput 
            [type]="hideConfirmPassword ? 'password' : 'text'"
            [(ngModel)]="confirmPassword" 
            name="confirmPassword"
            placeholder="Repite la contraseña"
            [disabled]="isLoading"
            required
          >
          <button 
            mat-icon-button 
            matSuffix 
            (click)="hideConfirmPassword = !hideConfirmPassword" 
            type="button"
            [disabled]="isLoading"
            [attr.aria-label]="'Toggle password visibility'"
          >
            <mat-icon>{{hideConfirmPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
        </mat-form-field>

        <!-- Password Requirements Info -->
        <div class="password-info">
          <mat-icon>info</mat-icon>
          <span>La contraseña debe tener al menos 6 caracteres</span>
        </div>

        <!-- Botón de Submit -->
        <button 
          mat-raised-button 
          color="primary" 
          type="submit"
          class="reset-button"
          [disabled]="!newPassword || !confirmPassword || isLoading"
        >
          @if (isLoading) {
            <mat-spinner diameter="20"></mat-spinner>
            <span>Restableciendo...</span>
          } @else {
            <span>Restablecer Contraseña</span>
          }
        </button>
      </form>

      <!-- Footer -->
      <div class="reset-password-footer">
        <button 
          mat-button 
          color="primary"
          class="back-button"
          (click)="goToLogin()"
          [disabled]="isLoading"
        >
          <mat-icon>arrow_back</mat-icon>
          Volver al Inicio de Sesión
        </button>
      </div>
    }
  </div>
</div>

